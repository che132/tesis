<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Sergio Perez-Limon">

<title>Dissertation - 2&nbsp; 2023_Highland_experiment_design</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./PT.html" rel="next">
<link href="./CML.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">2023_Highland_experiment_design</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Dissertation</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">MAGIC</span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./CML.html" class="sidebar-item-text sidebar-link">CML</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./CML-2023-03-12-23_Highland_Ameca_Experimental_Design.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">2023_Highland_experiment_design</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./PT.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">PT</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./AMF.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">AMF</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Summary</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">2023_Highland_experiment_design</span></h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Sergio Perez-Limon </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<p>Here I use the FieldHub app to design the field evaluation of the CML F2:3 population, for the Highlands we’re using a p-rep design (more info: 10.1198/108571106X154443). In total there are going to be 210 genotypes of the HI73 and HI93 populations, 320 from the HI79 and Hermes as a CHECK evaluated in two locations. For this experimental design, 70 genotypes of each biparental population are going to be replicated, and the rest (140, 140 and 250 respectively) are going as single reps. The families are selected based on the phc BLUP value. It is important to note that we’re only removing a few families based on this, so there is not an important bias/selection towards the best genotypes, but it might help us to select families that are going to survive. We select the families that are going to be repeated randomly. Check is repeated 50 times. The ecperiment is designed for a 25 columns x 40 rows experiment.</p>
<p>There is an augmented block design for Ameca, a possible “no stress” environment where we can have a baseline to compare the performance of the highland site. Here, the experiment is composed of a 53 block per repetition, and 2 replications, with the same genotypes as the p-rep design. Each genotype is present only once per replication and is not repeated across block either.</p>
<p>Loading libraries</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'googlesheets4' was built under R version 4.2.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'googledrive'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:googlesheets4':

    request_generate, request_make</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
✔ ggplot2 3.4.1      ✔ purrr   1.0.1 
✔ tibble  3.1.8      ✔ dplyr   1.0.10
✔ tidyr   1.3.0      ✔ stringr 1.5.0 
✔ readr   2.1.3      ✔ forcats 0.5.2 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggplot2' was built under R version 4.2.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tidyr' was built under R version 4.2.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'readr' was built under R version 4.2.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'purrr' was built under R version 4.2.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'dplyr' was built under R version 4.2.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'stringr' was built under R version 4.2.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'forcats' was built under R version 4.2.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter()                 masks stats::filter()
✖ dplyr::lag()                    masks stats::lag()
✖ googledrive::request_generate() masks googlesheets4::request_generate()
✖ googledrive::request_make()     masks googlesheets4::request_make()</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'lme4' was built under R version 4.2.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Matrix</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'Matrix' was built under R version 4.2.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'Matrix'

The following objects are masked from 'package:tidyr':

    expand, pack, unpack</code></pre>
</div>
</div>
<p>Import available genotypes and genotype information</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>✔ Reading from "CML457_459_Populations".</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ Range ''Genetic Stocks''.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ Reading from "21_NCS_PSU_LANGEBIO_FIELDS".</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ Range ''UNISEM21A'!2:10000000'.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
✔ Reading from "CML457_459_Populations".
✔ Range ''Genetic Stocks''.
✔ Reading from "CML457_459_Populations".
✔ Range ''seed_packing_2022''.
• `` -&gt; `...16`
• `` -&gt; `...18`</code></pre>
</div>
</div>
<p>Highland site p-rep design</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>✔ Reading from "CML457_459_Populations".</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ Range ''22_Highland_Raw_data_tidy''.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining, by = "family"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Warning message: 
 Since plotNumber was missing, it was set up to default value of:  1001 2001 
 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Joining, by = c("rep", "id")Joining, by = "treatment"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,000 × 12
      id expt  location year   plot   row column checks entry treatment family  
   &lt;int&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt; &lt;dbl&gt; &lt;int&gt;  &lt;int&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;   
 1     1 Expt1 SITE1    2023   1001     1      1 186      186 G186      HI93-271
 2     2 Expt1 SITE1    2023   1002     1      2 0        574 G574      HI79-370
 3     3 Expt1 SITE1    2023   1003     1      3 0        218 G218      HI73-028
 4     4 Expt1 SITE1    2023   1004     1      4 0        508 G508      HI79-280
 5     5 Expt1 SITE1    2023   1005     1      5 0        567 G567      HI79-306
 6     6 Expt1 SITE1    2023   1006     1      6 115      115 G115      HI79-286
 7     7 Expt1 SITE1    2023   1007     1      7 0        444 G444      HI79-321
 8     8 Expt1 SITE1    2023   1008     1      8 0        384 G384      HI79-191
 9     9 Expt1 SITE1    2023   1009     1      9 1          1 G1        CHECK   
10    10 Expt1 SITE1    2023   1010     1     10 0        482 G482      HI79-104
# … with 1,990 more rows, and 1 more variable: pop &lt;chr&gt;</code></pre>
</div>
<div class="cell-output-display">
<p><img src="CML-2023-03-12-23_Highland_Ameca_Experimental_Design_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining, by = "Female genotype"</code></pre>
</div>
</div>
<p>Ameca augmented complete block design</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  pop       n  prop     a
  &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
1 HI73    210 0.284  6.81
2 HI79    320 0.432 10.4 
3 HI93    210 0.284  6.81</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 740</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
     nn     n
  &lt;dbl&gt; &lt;int&gt;
1    14    53</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  pop       n  prop     a
  &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
1 HI73    210 0.284  3.97
2 HI79    320 0.432  6.05
3 HI93    210 0.284  3.97</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 3
    rep what       n
  &lt;dbl&gt; &lt;chr&gt;  &lt;int&gt;
1     1 HERMES    53
2     1 HI73     211
3     1 HI79     317
4     1 HI93     212
5     2 HERMES    53
6     2 HI73     211
7     2 HI79     318
8     2 HI93     211</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,586 × 10
      id  plot   row column checks block   rep treatment pop    family  
   &lt;int&gt; &lt;dbl&gt; &lt;int&gt;  &lt;int&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;  &lt;chr&gt;   
 1     1   101     1      1 0          1     1 G658      HI93   HI93-179
 2     2   102     1      2 1          1     1 CH1       HERMES HERMES  
 3     3   103     1      3 0          1     1 G205      HI73   HI73-092
 4     4   104     1      4 0          1     1 G133      HI93   HI93-233
 5     5   105     1      5 0          1     1 G641      HI93   HI93-108
 6     6   106     1      6 0          1     1 G321      HI73   HI73-137
 7     7   107     1      7 0          1     1 G418      HI73   HI73-220
 8     8   108     1      8 0          1     1 G44       HI79   HI79-162
 9     9   109     1      9 0          1     1 G636      HI79   HI79-268
10    10   110     1     10 0          1     1 G391      HI73   HI73-248
# … with 1,576 more rows</code></pre>
</div>
<div class="cell-output-display">
<p><img src="CML-2023-03-12-23_Highland_Ameca_Experimental_Design_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining, by = "Female genotype"</code></pre>
</div>
</div>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./CML.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">CML</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./PT.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">PT</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>